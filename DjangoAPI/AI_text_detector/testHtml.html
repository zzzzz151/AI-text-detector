<html>
   <head>
      <title>Example Document</title>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
   </head>
   <body>
      <h1>Welcome to my website</h1>
      <div>
         This text is inside a simple div, it should be detected by the web scraper!
         <p>
            This is my complex p tag
            <span> A wild span appears in the middle of it! </span>
            Got rid of the span but an 'a' tag next
            <a href='http://www.example.com'>Click here to go to my website where youll find all my work</a>
         </p>
         <h1>This is my text inside my h1 tag<h2>And now I am insde an h2 tag but still inside the h1 tag</h2></h1>
      </div>
      <br />
      <span> Normal independent span with some text <span>But a wild nested span appears</span> Got rid of the nested span, thankfully</span>
      <br />
      <p>Artificial intelligence (AI) has revolutionized the way we interact with technology and has become an integral part of our daily lives. AI-powered virtual assistants like Siri and Alexa have made it easier for us to access information and manage our daily tasks. Machine learning algorithms are helping businesses improve their products and services by analyzing customer data and predicting future trends. AI is also being used in healthcare to develop more accurate diagnostic tools and personalized treatment plans. As AI continues to advance, it has the potential to create even more opportunities and solve complex problems in fields like climate change and energy conservation.</p>
      <br />
      <p>I like turtles. Do you? Awesome! hahaha. lol!!! What's going on????</p>
      <script>
         console.log(myHash(document.documentElement.outerHTML));
         //console.log(document.documentElement.outerHTML);
         
         function myHash(string) {
            let hash_val = 0;
            const prime1 = 31;
            const prime2 = 37;
            for (let i = 0; i < string.length; i++) {
               hash_val = (hash_val * prime1 + string.charCodeAt(i)) % prime2;
            }
            return hash_val;
         }
      </script>
      <script>
         const relevantTags = ["div", "p", "span", "h1", "h2", "h3", "h4", "h5", "h6"];

         console.log($("div").text());

         $('div, p, span, h1, h2, h3, h4, h5, h6').each(function() {
            var hasText = $(this).text().length != 0;

            if (!hasText)
               return;

            let elem = $(this);
            while (elem.parent().length != 0)
            {
               elem = elem.parent();
               let thisTag = elem.prop("tagName");
               if (thisTag == null || thisTag == undefined)
                  continue;
               thisTag = elem.prop("tagName").toLowerCase();
               if (relevantTags.includes(thisTag))
                  return;
            }

            var txt = $(this).text().replace(/ +/g, ' '); // replace many spaces by 1 space

            let sentences = txt.match(/[^\.!\?]+[\.!\?]+/g);
            if (sentences == null || sentences == undefined)
            {
               fetch("http://localhost:8000/api/v1", {
                    method: "POST",
                    headers: {
                      "Content-Type": "text/plain"
                    },
                    body: txt
                  })
                    .then(response => response.json())
                    .then(data => {
                        if (data.probability_AI_generated > 50)
                        {
                           $(this)[0].innerHTML = $(this)[0].innerHTML.replace(txt, "<span style=\"background-color:red\">" + txt + "</span>");
                        }
                    })
                    .catch(error => console.error(error));
            }
            else
            {
               for (let i = 0; i < sentences.length; i++) {
                  let sentence = sentences[i].trim();

                  fetch("http://localhost:8000/api/v1", {
                    method: "POST",
                    headers: {
                      "Content-Type": "text/plain"
                    },
                    body: sentence
                  })
                    .then(response => response.json())
                    .then(data => {
                        if (data.probability_AI_generated > 50)
                        {
                           $(this)[0].innerHTML = $(this)[0].innerHTML.replace(sentence, "<span style=\"background-color:red\">" + sentence + "</span>");
                        }
                    })
                    .catch(error => console.error(error));

               }
            }

            //console.log("type: " + $(this)[0].tagName + " text: " + $(this).text());
         });
         
      </script>
   </body>
</html>